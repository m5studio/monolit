{% extends 'base.html' %}

{% load custom_filters %}

{% block body_classes %}{% spaceless %}
    {{ block.super }} flat-page
{% endspaceless %}{% endblock %}


{% block content %}
    <nav id="breadcrumbs">
        <div class="container">
            <ol class="breadcrumb">
                <li class="breadcrumb-item">
                    <a href="{% url 'homepage' %}">Главная</a>
                </li>
                <li class="breadcrumb-item">
                    <a href="{% url 'object:site-list' %}">Выбор недвижимости</a>
                </li>
                <li class="breadcrumb-item">
                    <a href="{% url 'object:detail' slug=object.object.slug %}">{{ object.object.get_object_type_display }} &laquo;{{ object.object.name }}&raquo;</a>
                </li>
                {% if object.object_section %}
                    <li class="breadcrumb-item">{{ object.object_section }}</li>
                {% endif %}
                {% if object.site_type %}
                    <li class="breadcrumb-item">{{ object.get_site_type_display }}</li>
                {% endif %}
                {% if object.floor %}
                    <li class="breadcrumb-item">Этаж {{ object.floor }}</li>
                {% endif %}
                <!-- <li class="breadcrumb-item active">Название квартиры</li> -->
            </ol>
        </div>
    </nav>

    <main id="main">
        <div id="section-flat-page-content" class="container">
            <div id="section-flat-page-content__left">
                {% if object.image_planning %}
                    <div id="section-flat-page-content__tabs">
                        <div class="nav nav-pills" id="flat-pills-tabs" role="tablist">
                            {% if object.image_planning %}
                                <a class="nav-link active" id="flat-pills-layout-tab" data-toggle="pill" href="#flat-pills-layout" role="tab" aria-controls="flat-pills-layout" aria-selected="true">Планировка</a>
                            {% endif %}
                            {% if object.image_planning3d %}
                                <a class="nav-link" id="flat-pills-layout-3d-tab" data-toggle="pill" href="#flat-pills-layout-3d" role="tab" aria-controls="flat-pills-layout-3d" aria-selected="false">Планировка 3D</a>
                            {% endif %}
                            {% if object.image_floor %}
                                <a class="nav-link" id="flat-pills-floor-tab" data-toggle="pill" href="#flat-pills-floor" role="tab" aria-controls="flat-pills-floor" aria-selected="false">Этаж</a>
                            {% endif %}
                            {% if object.image_section %}
                                <a class="nav-link" id="flat-pills-section-tab" data-toggle="pill" href="#flat-pills-section" role="tab" aria-controls="flat-pills-section" aria-selected="false">Секция</a>
                            {% endif %}
                            {% if object.image_section_in_object %}
                                <a class="nav-link" id="flat-pills-house-tab" data-toggle="pill" href="#flat-pills-house" role="tab" aria-controls="flat-pills-house" aria-selected="false">Дом</a>
                            {% endif %}
                            {% if object.image_genplan %}
                                <a class="nav-link" id="flat-pills-genplan-tab" data-toggle="pill" href="#flat-pills-genplan" role="tab" aria-controls="flat-pills-genplan" aria-selected="false">Генплан</a>
                            {% endif %}
                        </div>
                        <div class="tab-content" id="flat-pills-tabs-content">
                            {% if object.image_planning %}
                                <div class="tab-pane fade show active" id="flat-pills-layout" role="tabpanel" aria-labelledby="flat-pills-layout-tab">
                                    <div class="tab-pane__img" style="background-image: url('{{ object.image_planning.url }}');"></div>
                                </div>
                            {% endif %}
                            {% if object.image_planning3d %}
                                <div class="tab-pane fade" id="flat-pills-layout-3d" role="tabpanel" aria-labelledby="flat-pills-layout-3d-tab">
                                    <div class="tab-pane__img" style="background-image: url('{{ object.image_planning3d.url }}');"></div>
                                </div>
                            {% endif %}
                            {% if object.image_floor %}
                                <div class="tab-pane fade" id="flat-pills-floor" role="tabpanel" aria-labelledby="flat-pills-floor-tab">
                                    <div class="tab-pane__img" style="background-image: url('{{ object.image_floor.url }}');"></div>
                                </div>
                            {% endif %}
                            {% if object.image_section %}
                                <div class="tab-pane fade" id="flat-pills-section" role="tabpanel" aria-labelledby="flat-pills-section-tab">
                                    <div class="tab-pane__img" style="background-image: url('{{ object.image_section.url }}');"></div>
                                </div>
                            {% endif %}
                            {% if object.image_section_in_object %}
                                <div class="tab-pane fade" id="flat-pills-house" role="tabpanel" aria-labelledby="flat-pills-house-tab">
                                    <div class="tab-pane__img" style="background-image: url('{{ object.image_section_in_object.url }}');"></div>
                                </div>
                            {% endif %}
                            {% if object.image_genplan %}
                                <div class="tab-pane fade" id="flat-pills-genplan" role="tabpanel" aria-labelledby="flat-pills-genplan-tab">
                                    <div class="tab-pane__img" style="background-image: url('{{ object.image_genplan.url }}');"></div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
            </div>

            <div id="section-flat-page-content__right">
                <div id="flat-id">ID: {{ object.crm_id }}</div>
                <div id="page-title-h1">
                    <h1>{{ page_title }}</h1>
                </div>
                <div id="flat-params" class="flat-content-block">
                    {% if object.rooms_qty %}
                        <div class="flat-params-block">
                            <div class="flat-params-block__name">Комнат</div>
                            <div class="flat-params-block__val">{{ object.rooms_qty }}</div>
                        </div>
                    {% endif %}
                    {% if object.floor %}
                        <div class="flat-params-block">
                            <div class="flat-params-block__name">Этаж</div>
                            <div class="flat-params-block__val">
                                <span class="flat-floor">{{ object.floor }}</span>
                                <span class="last-floor">{% if object.object_section.floor_last %}/{{ object.object_section.floor_last }}{% endif %}</span>
                            </div>
                        </div>
                    {% endif %}
                    {% if object.ceiling_height %}
                        <div class="flat-params-block">
                            <div class="flat-params-block__name">Выстота потолка</div>
                            <div class="flat-params-block__val">{{ object.ceiling_height }} м</div>
                        </div>
                    {% endif %}
                    {% if object.site_area %}
                        <div class="flat-params-block">
                            <div class="flat-params-block__name">Общая площадь</div>
                            <div class="flat-params-block__val">{{ object.site_area }} м<sup>2</sup></div>
                        </div>
                    {% endif %}
                    {% if object.living_area %}
                        <div class="flat-params-block">
                            <div class="flat-params-block__name">Жилая площадь</div>
                            <div class="flat-params-block__val">{{ object.living_area }} м<sup>2</sup></div>
                        </div>
                    {% endif %}
                    {% if object.kitchen_area %}
                        <div class="flat-params-block">
                            <div class="flat-params-block__name">Площадь кухни</div>
                            <div class="flat-params-block__val">{{ object.kitchen_area }} м<sup>2</sup></div>
                        </div>
                    {% endif %}
                </div>

                <div id="flat-params-secondary" class="flat-content-block">
                    <div class="h4">Доп информация</div>
                    <div id="flat-params-secondary__inner">
                        {% if object.site_number %}
                            <div class="flat-params-block">
                                <div class="flat-params-block__name">Номер</div>
                                <div class="flat-params-block__val">{{ object.site_number }}</div>
                            </div>
                        {% endif %}
                        {% if object.two_levels %}
                            <div class="flat-params-block">
                                <div class="flat-params-block__name">Два уровня</div>
                                <div class="flat-params-block__val">Да</div>
                            </div>
                        {% endif %}
                        {% if object.entresol %}
                            <div class="flat-params-block">
                                <div class="flat-params-block__name">Антресоль</div>
                                <div class="flat-params-block__val">Есть</div>
                            </div>
                        {% endif %}
                        {% if object.wardrobe %}
                            <div class="flat-params-block">
                                <div class="flat-params-block__name">Гардеробная</div>
                                <div class="flat-params-block__val">Есть</div>
                            </div>
                        {% endif %}
                        {% if object.finish_type %}
                            <div class="flat-params-block">
                                <div class="flat-params-block__name">Отделка</div>
                                <div class="flat-params-block__val">{{ object.get_finish_type_display }}</div>
                            </div>
                        {% endif %}
                        {% if object.window_view %}
                            <div class="flat-params-block">
                                <div class="flat-params-block__name">Вид</div>
                                <div class="flat-params-block__val">{{ object.window_view.all|join:', ' }}</div>
                            </div>
                        {% endif %}
                        {% if bathrooms %}
                            <div class="flat-params-block">
                                <div class="flat-params-block__name">Санузел</div>
                                <div class="flat-params-block__val">
                                    {% for bath in bathrooms %}
                                        {{ bath.bathroom_qty }} {{ bath.get_bathroom_type_display }}
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}
                        {% if balconies %}
                            <div class="flat-params-block">
                                <div class="flat-params-block__name">Балкон</div>
                                <div class="flat-params-block__val">
                                    {% for balcony in balconies %}
                                        {{ balcony.balcony_qty }} {{ balcony.get_balcony_type_display }}<br>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}
                        {% if elevators %}
                            <div class="flat-params-block">
                                <div class="flat-params-block__name">Лифт</div>
                                <div class="flat-params-block__val">
                                    {% for elevator in elevators %}
                                        {{ elevator.elevator_qty }} {{ elevator.get_elevator_type_display }}<br>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>

                {% if object.price_per_square and object.price_total %}
                    <div id="flat-price" class="flat-content-block--flex">
                        <div id="flat-price__per-meter" class="flat-price-block">
                            <div class="flat-price-block__name">Стоимость кв. метра</div>
                            <div class="flat-price-block__val">{{ object.price_per_square|format_and_round_number }} руб/м<sup>2</sup></div>
                        </div>
                        <div id="flat-price__total" class="flat-price-block">
                            <div class="flat-price-block__name">Стоимость квартиры</div>
                            <div class="flat-price-block__val">{{ object.price_total|format_and_round_number }} руб.</div>
                        </div>
                    </div>
                {% endif %}

                <div id="flat-actions" class="flat-content-block--grid">
                    <div id="flat-actions__book-flat" class="flat-actions-block">
                        <button class="green-button">Забронировать квартиру</button>
                    </div>
                    <div id="flat-actions__actions-panel" class="flat-actions-block--flex-end">
                        <ul>
                            <li>
                                <a href=""><span class="icon icon-32 icon-heart-contour-green"></span> Добавить в избранное</a>
                            </li>
                            <li>
                                <a href="" target="_blank" title="Откроется в новой вкладке"><span class="icon icon-32 icon-print-solid-green"></span> Распечатать в PDF</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div id="section-flat-page-map" class="flat-page-section">
        <div class="flat-page-section__title container">Что находится рядом</div>
        <div id="section-flat-page-map__holder" class="flat-page-section__content"></div>
    </div>

    <div id="section-flat-page-mortgage" class="flat-page-section container">
        <div class="flat-page-section__title">Ипотека</div>
        <div class="flat-page-section__content">
            <div id="section-flat-page-mortgage__offers">
                <div class="mortgage-offer">
                    <div class="mortgage-offer__bank-logo">
                        <div class="mortgage-offer__best-offer">Лучшее предложение</div>
                        <div class="bank-logo bank-logo__rnkb"></div>
                    </div>
                    <div class="mortgage-offer__descr">Ипотека с государственной поддержкой</div>
                    <div class="mortgage-offer__loan-rate">
                        <div class="mortgage-offer__title">% ставка</div>
                        <div class="mortgage-offer__val">6%</div>
                    </div>
                    <div class="mortgage-offer__first-payment">
                        <div class="mortgage-offer__title">Первый взнос</div>
                        <div class="mortgage-offer__val">от 20%</div>
                    </div>
                    <div class="mortgage-offer__pay-off">
                        <div class="mortgage-offer__title">Срок кредита</div>
                        <div class="mortgage-offer__val">до 25 лет</div>
                    </div>
                    <div class="mortgage-offer__monthly-payment">
                        <div class="mortgage-offer__title">Ежемесячный платеж</div>
                        <div class="mortgage-offer__val">18700 руб.</div>
                    </div>
                </div>
                <div class="mortgage-offer">
                    <div class="mortgage-offer__bank-logo">
                        <div class="bank-logo bank-logo__rossiya"></div>
                    </div>
                    <div class="mortgage-offer__descr">"Новые метры"</div>
                    <div class="mortgage-offer__loan-rate">
                        <div class="mortgage-offer__title">% ставка</div>
                        <div class="mortgage-offer__val">от 9%</div>
                    </div>
                    <div class="mortgage-offer__first-payment">
                        <div class="mortgage-offer__title">Первый взнос</div>
                        <div class="mortgage-offer__val">от 15%</div>
                    </div>
                    <div class="mortgage-offer__pay-off">
                        <div class="mortgage-offer__title">Срок кредита</div>
                        <div class="mortgage-offer__val">3 - 25 лет</div>
                    </div>
                    <div class="mortgage-offer__monthly-payment">
                        <div class="mortgage-offer__title">Ежемесячный платеж</div>
                        <div class="mortgage-offer__val">22400 руб.</div>
                    </div>
                </div>
                <div class="mortgage-offer">
                    <div class="mortgage-offer__bank-logo">
                        <div class="bank-logo bank-logo__rossiya"></div>
                    </div>
                    <div class="mortgage-offer__descr">Военная ипотека</div>
                    <div class="mortgage-offer__loan-rate">
                        <div class="mortgage-offer__title">% ставка</div>
                        <div class="mortgage-offer__val">от 9%</div>
                    </div>
                    <div class="mortgage-offer__first-payment">
                        <div class="mortgage-offer__title">Первый взнос</div>
                        <div class="mortgage-offer__val">от 20%</div>
                    </div>
                    <div class="mortgage-offer__pay-off">
                        <div class="mortgage-offer__title">Срок кредита</div>
                        <div class="mortgage-offer__val">1 - 20 лет</div>
                    </div>
                    <div class="mortgage-offer__monthly-payment">
                        <div class="mortgage-offer__title">Ежемесячный платеж</div>
                        <div class="mortgage-offer__val">22400 руб.</div>
                    </div>
                </div>
                <div class="mortgage-offer">
                    <div class="mortgage-offer__bank-logo">
                        <div class="bank-logo bank-logo__rnkb"></div>
                    </div>
                    <div class="mortgage-offer__descr">Военная ипотека</div>
                    <div class="mortgage-offer__loan-rate">
                        <div class="mortgage-offer__title">% ставка</div>
                        <div class="mortgage-offer__val">от 9.5%</div>
                    </div>
                    <div class="mortgage-offer__first-payment">
                        <div class="mortgage-offer__title">Первый взнос</div>
                        <div class="mortgage-offer__val">от 10%</div>
                    </div>
                    <div class="mortgage-offer__pay-off">
                        <div class="mortgage-offer__title">Срок кредита</div>
                        <div class="mortgage-offer__val">3 - 20 лет</div>
                    </div>
                    <div class="mortgage-offer__monthly-payment">
                        <div class="mortgage-offer__title">Ежемесячный платеж</div>
                        <div class="mortgage-offer__val">23100 руб.</div>
                    </div>
                </div>
                <div class="mortgage-offer">
                    <div class="mortgage-offer__bank-logo">
                        <div class="bank-logo bank-logo__rnkb"></div>
                    </div>
                    <div class="mortgage-offer__descr">"Новостройка"</div>
                    <div class="mortgage-offer__loan-rate">
                        <div class="mortgage-offer__title">% ставка</div>
                        <div class="mortgage-offer__val">от 9.5%</div>
                    </div>
                    <div class="mortgage-offer__first-payment">
                        <div class="mortgage-offer__title">Первый взнос</div>
                        <div class="mortgage-offer__val">от 10%</div>
                    </div>
                    <div class="mortgage-offer__pay-off">
                        <div class="mortgage-offer__title">Срок кредита</div>
                        <div class="mortgage-offer__val">3 - 20 лет</div>
                    </div>
                    <div class="mortgage-offer__monthly-payment">
                        <div class="mortgage-offer__title">Ежемесячный платеж</div>
                        <div class="mortgage-offer__val">23100 руб.</div>
                    </div>
                </div>
                <div class="mortgage-offer">
                    <div class="mortgage-offer__bank-logo">
                        <div class="bank-logo bank-logo__rnkb"></div>
                    </div>
                    <div class="mortgage-offer__descr">"Простая ипотека"<br>Только паспорт и СНИЛС</div>
                    <div class="mortgage-offer__loan-rate">
                        <div class="mortgage-offer__title">% ставка</div>
                        <div class="mortgage-offer__val">от 12.5%</div>
                    </div>
                    <div class="mortgage-offer__first-payment">
                        <div class="mortgage-offer__title">Первый взнос</div>
                        <div class="mortgage-offer__val">от 35%</div>
                    </div>
                    <div class="mortgage-offer__pay-off">
                        <div class="mortgage-offer__title">Срок кредита</div>
                        <div class="mortgage-offer__val">3 - 25 лет</div>
                    </div>
                    <div class="mortgage-offer__monthly-payment">
                        <div class="mortgage-offer__title">Ежемесячный платеж</div>
                        <div class="mortgage-offer__val">27300 руб.</div>
                    </div>
                </div>
            </div>
            <div id="section-flat-page-mortgage__request">
                <a href="" class="green-button">Оформить заявку на ипотеку</a>
            </div>
        </div>
    </div>

    {% if simular_flats %}
        <div id="section-flat-page-simular-flats" class="flat-page-section container">
            <div class="flat-page-section__title">Похожие квартиры в {{ object.object.get_object_type_display }} {{ object.object.name }}</div>
            <div id="section-flat-page-simular-flats__inner" class="flat-page-section__content">
                <div id="flats-simular">
                    <div id="flats-simular__total">{{ simular_flats_count }}</div>
                    <div id="flats-simular__simular-objects">Похож{% if simular_flats_count < 2 %}ая{% else %}их{% endif %}<br>квартир{% if simular_flats_count < 2 %}а{% elif simular_flats_count < 5 %}ы{% else %}{% endif %}<br>в объекте</div>
                    <div id="flats-simular__see-all">
                        <a href="">
                            <span>Смотреть все</span>
                            <div class="icon icon-arrow-right-green"></div>
                        </a>
                    </div>
                </div>
                {% for object in simular_flats %}
                    {% include 'realty/cards/flat-card.html' %}
                {% endfor %}
            </div>
        </div>
    {% endif %}
{% endblock %}
